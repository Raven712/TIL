# 서브쿼리 2



### 다중행 서브쿼리

- users에서 이은정과 같은지역에 사는 사람의 수는?

```sqlite
방금 했던대로 하면 안될까?
SELECT COUNT(*) FROM users WHERE country = (SELECT country FROM users WHERE last_name = '이', first_name = '은정');

문제: 이 은정이 한사람이 아닐수 있음. (이은정이 전라도에도 있고 경상도에도 있으면, 위의 쿼리는 한군데 사람들 수만 출력해버림!)


---> IN 을 사용하면됨.
SELECT COUNT(*) FROM users WHERE country IN (SELECT country FROM users WHERE last_name = '이', first_name = '은정');									= 자리에 IN이 들어감.
```



- 결국, 다중행 서브쿼리는 서브쿼리 결과가 2개 이상인경우 (위처럼 이은정이 여러군데 사는상황)
- 다중행 비교연산자와 함께 사용 (IN, EXISTS 등. ALL ANY SOME 이런것들도 있는데 DBMS마다 연산자가 다름.



### 다중칼럼 서브쿼리

- 특정 성씨에서 가장 어린 사람들의 이름과 나이를 모두 출력하기.

```sqlite
- 내 생각
SELECT last_name, first_name, age FROM users WHERE ....;; 모르겠음


 1. 특정 성씨별로 그룹화
 2. 가장 적은 나이 찾기.
 
 SELECT
 	last_name,
 	MIN(age)
 FROM users
 GROUP BY last_name; 
 
 
 SELECT last_name, first_name, age FROM users
 WHERE (last_name, age) IN ( SELECT
 	last_name,
 	MIN(age)
 FROM users
 GROUP BY last_name; )
 ORDER BY last_name;
```


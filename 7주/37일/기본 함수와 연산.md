# 기본 함수와 연산

- 문자열 함수
  - SUBSTR(문자열, start, length) : 문자열 자르기
    - 시작인덱스는 1, 마지막 인덱스는 -1
  - TRIM(문자열) : STRIP이랑 같음.
  - LENGTH(문자열) :문자열 길이
    - sqlite> SELECT LENGTH(first_name), first_name FROM users LIMIT 5;
      - 이름 길이와 이름이 5개 나옴.
  - REPLACE(문자열, 패턴, 변경값): 패턴에 일치하는 부분을 변경
    - sqlite> SELECT REPLACE(phone, '-', '') FROM users LIMIT 5;
      - 전화번호의 - 가 사라져서 나옴.
  - UPPER(문자열), LOWER(문자열) : 대소문자 변경
  - || : 문자열 합치기 (A II B C --> A랑 B를 합친걸 C로 표현하겠다.) 
    - SELECT last_name || first_name name FROM users LIMIT 5;
    - SHIFT + \ 임.



- 숫자 함수
  - ABS(숫자) : 절대값
  - SIGN(숫자) : 부호 (양수는 1, 음수는 -1, 0은 0)
  - MOD(숫자1, 숫자2) : 숫자1을 2로 나눈 나머지
  - CEIL(숫자), FLOOR(숫자), ROUND(숫자, 자리) : 올림, 내림, 반올림
    - sqlite> SELECT CEIL(3.14), FLOOR(3.14), ROUND(3.14) FROM users LIMIT 1;
      - 4.0         3.0          3.0
  - POWER(숫자1, 2) : 숫자1의 숫자2 제곱
  - SQRT(숫자) : 루트





### GROUP BY

- 집계함수 다시보기
  - SUM, COUNT, AVG, MAX, MIN...
  - 각 집합에 대한 계산을 수행하고 단일값을 반환



- SELECT 문의 optional 절
- 행 집합에서 요약행집합 만듬
- 선택된 행 그룹을 하나이상의 열값으로 요약행 만듬?
- SELECT * FROM 테이블이름 GROUP BY 컬럼1,2 ;



- SELECT AVG(age) FROM users GROUP BY 성; < 이러면,
  - 성이라는 필드의 평균나이가 나타남. (김씨 평균 이씨평균...)
  - group by 를 하면 이름도 오름차순 정렬이 됨. 근데 완전 정렬되는게 아니니 order by를 쓰는게 맞음.



- group by를 하는데 100개이상 등장한 성을 출력하고싶다?
  - group by 테이블
  - HAVING COUNT(테이블) > 100; 이래야됨 (조건에 따른 GROUP)



- SELECT 문장 실행순서

  - SELECT -> FROM -> WHERE -> GROUP BY -> HAVING -> SELECT -> ORDER

    

  - 하지만 정의는

  - SELECT 칼럼명

  - FROM 테이블명

  - WHERE 조건식

  - GROUP BY 칼럼혹은 표현식

  - HAVING 그룹조건식

  - ORDER BY 칼럼 혹은 표현식

  - LIMIT 숫자 OFFSET 숫자;

    

### ALTER TABLE

- 테이블의 컬럼이 변경된다거나 테이블이름 바뀐다거나 할수있음



- ALTER TABLE
  - 테이블이름변경
    - ALTER TABLE (테이블 이름) RENAME TO (새이름);
  - 새 칼럼 추가
    - ALTER TABLE 테이블이름 ADD COLUMN 정의할이름 TEXT NOT NULL DEFAULT '소제목'; // 이런식으로 ---> DEFAULT가 없으면 에러걸림. NOT NULL을 없애거나 디폴트를 추가해야함
  - 칼럼 이름수정
    - ALTER TABLE 테이블이름 RENAME COLUMN 현재이름  TO 새 이름;
  - 칼럼 삭제
    - ALTER TABLE 테이블이름 DROP COLUMN 칼럼이름;